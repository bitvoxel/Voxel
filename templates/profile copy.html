<html>
<head>
    <title>Kazhak - Student Profile</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='base.css') }}">
    <style>
        /* Additional styles can be added here if needed */
    </style>
</head>
<body>
    <div id="header_wrapper">
        <div id="header">
            <div id="title">Kazhak</div>
            <br>Student Profile
            <nav>
                <ul>
                    <li><a href="/" style="font-size: 3vh;">Chatbot</a></li>
                    <li><a href="/student" style="font-size: 3vh;">Students</a></li>
                    <li><a href="/teacher" style="font-size: 3vh;">Teachers</a></li>
                </ul>
            </nav>
        </div>
    </div>

    <div id="student_details">
        <h2><u>Student Details</u></h2>
        <p><strong>Roll No:</strong> <span id="profile_roll"></span></p>
        <p><strong>Name:</strong> <span id="profile_name"></span></p>
        <p><strong>Class:</strong> <span id="profile_class"></span></p>
        <p><strong>Date of Joining:</strong> <span id="profile_join_date"></span></p>
        <p><strong>Date of Birth:</strong> <span id="profile_dob"></span></p>
    </div>

    <div id="marks_list">
        <h2><u>Marks</u></h2>
        <table id="marks_table">
            <thead>
                <tr>
                    <th><u>Exam ID</u></th>
                    <th><u>Maths</u></th>
                    <th><u>Physics</u></th>
                    <th><u>Chemistry</u></th>
                    <th><u>English</u></th>
                    <th><u>Computer</u></th>
                    <th><u>Biology</u></th>
                </tr>
            </thead>
            <tbody id="marks_body">
                <!-- Marks records will be populated here -->
            </tbody>
        </table>
    </div>

    <script>
        async function fetchStudentProfile(rollno) {
            // Fetch student details
            const studentResponse = await fetch(`/fetch_student_by_id`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ roll: rollno })
            });
            var student = await studentResponse.json();
            student=student[0]
            console.log(student);
            
            // Populate student details
            document.getElementById("profile_roll").innerText = student[0];
            document.getElementById("profile_name").innerText = student[1];
            document.getElementById("profile_class").innerText = student[2];
            document.getElementById("profile_join_date").innerText = student[3];
            document.getElementById("profile_dob").innerText = student[4];

            // Fetch student marks
            const marksResponse = await fetch("/fetch_marks_by_student", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ rollno: rollno })
            });
            const marks = await marksResponse.json();
            console.log(marks);
            

            // Populate marks table
            const marksBody = document.getElementById("marks_body");
            marksBody.innerHTML = "";
            
            marks.forEach(mark => {
                const row = `<tr>
                    <td>${mark[1]}</td>
                    <td>${mark[2]}</td>
                    <td>${mark[3]}</td>
                    <td>${mark[4]}</td>
                    <td>${mark[5]}</td>
                    <td>${mark[6]}</td>
                    <td>${mark[7]}</td>
                </tr>`;
                marksBody.innerHTML += row;
            });
        }

        // Get the roll number from the URL or a predefined value
        fetchStudentProfile('{{roll}}');
        
    </script>
</body>
</html>